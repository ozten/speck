{"id":"speck-0fi","title":"Implement spec plan interactive pushback loop","description":"Implement the interactive conversation loop for spec plan. When the planner encounters under-specified requirements, ambiguous verification, or needs user decisions (e.g., which approach for component testing), it presents options and waits for input. The loop continues until all task specs have verification strategies or the user explicitly stops.\n\nPRD ref: The Interactive Pushback Loop (with full example conversation).\n\n## Done when\n- [ ] `src/plan/conversation.rs` implements the interactive loop: present findings -\u003e ask questions -\u003e refine specs -\u003e repeat\n- [ ] When a task's signal can't be classified, presents specific options to the user (like the PRD example)\n- [ ] Supports adding new foundational tasks discovered during conversation\n- [ ] Supports updating existing task specs based on user feedback\n- [ ] Supports the user saying \"stop\" or \"accept\" to finalize current specs\n- [ ] Reads user input from stdin, prints to stdout\n- [ ] Unit tests with replaying cassettes (simulated user input)\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test conversation`\n- Expect: All conversation loop tests pass\n\n## Affected files\n- src/plan/conversation.rs (new)\n- src/plan/mod.rs (modified)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-0fi","depends_on_id":"speck-118","type":"blocks","created_at":"2026-02-20T17:47:22.514699716Z","created_by":"Austin King"}]}
{"id":"speck-118","title":"Implement spec plan pass 2: deep requirement decomposition","description":"Implement the second pass of planning: deep per-requirement exploration. Given a survey result and a specific requirement, does focused exploration of the modules it touches, determines actual changes needed, discovers existing patterns, and produces task specs with real acceptance criteria and signal classification.\n\nPRD ref: Two-Pass Planning — Pass 2: Deep Dive. The Signal Taxonomy. The Pushback Rule.\n\n## Done when\n- [ ] `src/plan/decompose.rs` implements decompose(ctx, survey_result, requirement) \n- [ ] Does focused reads of specific files/modules identified by the survey (via ctx.fs)\n- [ ] Uses ctx.llm to propose task decomposition with acceptance criteria\n- [ ] Classifies each task's signal type using the signal classification logic\n- [ ] Proposes verification strategy for each task\n- [ ] Returns PushbackRequired for any task where verification strategy cannot be determined\n- [ ] Returns a list of TaskSpec drafts (not yet saved)\n- [ ] Unit tests with replaying cassettes\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test decompose`\n- Expect: All decomposition tests pass — produces task specs with signal types and verification strategies\n\n## Affected files\n- src/plan/decompose.rs (new)\n- src/plan/mod.rs (modified)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-118","depends_on_id":"speck-nag","type":"blocks","created_at":"2026-02-20T17:47:22.44789613Z","created_by":"Austin King"},{"issue_id":"speck-118","depends_on_id":"speck-7lp","type":"blocks","created_at":"2026-02-20T17:47:22.470737209Z","created_by":"Austin King"},{"issue_id":"speck-118","depends_on_id":"speck-p81","type":"blocks","created_at":"2026-02-20T17:47:22.492230217Z","created_by":"Austin King"}]}
{"id":"speck-1a1","title":"Wire spec plan subcommand in CLI","description":"Wire the plan subcommand in main.rs. Supports both inline requirement text and --from file. Orchestrates the full planning pipeline: survey -\u003e decompose -\u003e pushback loop -\u003e reconcile -\u003e save specs.\n\nPRD ref: CLI Design — spec plan, spec plan --from.\n\n## Done when\n- [ ] \\`speck plan \\\"requirement text\\\"\\` runs the full planning pipeline interactively\n- [ ] \\`speck plan --from requirements.md\\` reads requirements from a file\n- [ ] Pipeline: survey -\u003e decompose -\u003e pushback loop -\u003e reconcile -\u003e save to store\n- [ ] Final output: list of created task spec IDs and their summaries\n- [ ] \\`cargo check\\` passes\n- [ ] \\`cargo test\\` passes\n\n## Verify\n- Run: \\`cargo run -- plan --help\\`\n- Expect: Shows usage with positional requirement arg and --from flag\n\n## Affected files\n- src/main.rs (modified — wire plan subcommand)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-1a1","depends_on_id":"speck-0fi","type":"blocks","created_at":"2026-02-20T17:47:22.560974577Z","created_by":"Austin King"},{"issue_id":"speck-1a1","depends_on_id":"speck-nae","type":"blocks","created_at":"2026-02-20T17:47:22.584445525Z","created_by":"Austin King"}]}
{"id":"speck-21i","title":"Build cassette-split utility for per-port decomposition","description":"Create a binary (src/bin/cassette_split.rs) that reads a monolithic cassette YAML file and splits it into per-port cassette files in an output directory. This enables the composable replay workflow.\n\nPRD ref: Cassette Files — Recording and Splitting. docs/deterministic-replay.md — Cassette Storage Layout.\n\n## Done when\n- [ ] `src/bin/cassette_split.rs` exists as a separate binary target\n- [ ] Takes two args: input monolithic cassette path, output directory\n- [ ] Creates output directory structure: `\u003coutdir\u003e/\u003cport_name\u003e/\u003ccassette_name\u003e.yaml`\n- [ ] Each per-port cassette contains only interactions for that port, with correct seq renumbering\n- [ ] Per-port cassette includes `source_session` field linking back to the original recording\n- [ ] Ports with zero interactions are skipped (no empty files)\n- [ ] Unit test: split a known monolithic cassette, verify per-port files have correct contents\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo run --bin cassette_split -- test_fixtures/monolithic.yaml /tmp/split_output/`\n- Expect: Creates per-port YAML files under /tmp/split_output/, each containing only that port's interactions\n\n## Affected files\n- src/bin/cassette_split.rs (new)\n- Cargo.toml (modified — add [[bin]] section)","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-21i","depends_on_id":"speck-peq","type":"blocks","created_at":"2026-02-20T17:47:07.23290396Z","created_by":"Austin King"}]}
{"id":"speck-7lp","title":"Implement signal type classification logic","description":"Implement the signal taxonomy classification engine. Given a requirement description and codebase context, classify the verification signal as clear, fuzzy-but-constrainable, or internal-logic. For each type, propose the appropriate verification strategy. This is the core of the pushback rule.\n\nPRD ref: The Signal Taxonomy, The Pushback Rule.\n\n## Done when\n- [ ] `src/plan/signal.rs` defines classification logic\n- [ ] For clear signals: returns a DirectAssertion verification strategy with proposed checks\n- [ ] For fuzzy signals: decomposes into structural sub-assertions that are individually clear\n- [ ] For internal logic signals: proposes either RefactorToExpose or TraceAssertion strategy\n- [ ] Returns a PushbackRequired result when classification fails (requirement is under-specified)\n- [ ] Uses LLM (via ctx.llm) to analyze requirements and propose classification\n- [ ] Unit tests with replaying cassettes covering each signal type and the pushback case\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test signal`\n- Expect: All signal classification tests pass — each signal type and pushback case covered\n\n## Affected files\n- src/plan/signal.rs (new)\n- src/plan/mod.rs (modified)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-7lp","depends_on_id":"speck-jrx","type":"blocks","created_at":"2026-02-20T17:47:22.357585388Z","created_by":"Austin King"},{"issue_id":"speck-7lp","depends_on_id":"speck-mzn","type":"blocks","created_at":"2026-02-20T17:47:22.380957712Z","created_by":"Austin King"}]}
{"id":"speck-9fi","title":"Implement replaying adapters for all ports","description":"Implement replaying adapters for all 7 port traits. Each replaying adapter reads from a CassetteReplayer and serves recorded responses. Also add ServiceContext::replaying() and ServiceContext::replaying_from(CassetteConfig) constructors.\n\nPRD ref: Hexagonal Architecture — Replaying Adapter Pattern, Composable Replay. docs/deterministic-replay.md — Replaying Adapter Pattern.\n\n## Done when\n- [ ] `src/adapters/replaying/clock.rs` — ReplayingClock serves recorded now() results\n- [ ] `src/adapters/replaying/filesystem.rs` — ReplayingFileSystem serves recorded fs results\n- [ ] `src/adapters/replaying/git.rs` — ReplayingGitRepo serves recorded git results\n- [ ] `src/adapters/replaying/shell.rs` — ReplayingShellExecutor serves recorded shell results\n- [ ] `src/adapters/replaying/id_gen.rs` — ReplayingIdGenerator serves recorded IDs\n- [ ] `src/adapters/replaying/llm.rs` — ReplayingLlmClient serves recorded completions\n- [ ] `src/adapters/replaying/issues.rs` — ReplayingIssueTracker serves recorded tracker results\n- [ ] `ServiceContext::replaying(path)` constructor loads a monolithic cassette\n- [ ] `ServiceContext::replaying_from(CassetteConfig)` constructor loads per-port cassettes\n- [ ] Unspecified ports in CassetteConfig panic with clear message when called\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test replaying`\n- Expect: Tests pass — a replaying context can be constructed and serves recorded data\n\n## Affected files\n- src/adapters/replaying/mod.rs (new)\n- src/adapters/replaying/clock.rs (new)\n- src/adapters/replaying/filesystem.rs (new)\n- src/adapters/replaying/git.rs (new)\n- src/adapters/replaying/shell.rs (new)\n- src/adapters/replaying/id_gen.rs (new)\n- src/adapters/replaying/llm.rs (new)\n- src/adapters/replaying/issues.rs (new)\n- src/adapters/mod.rs (modified)\n- src/context.rs (modified — add replaying constructors)","status":"open","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-9fi","depends_on_id":"speck-sm5","type":"blocks","created_at":"2026-02-20T17:47:07.139958079Z","created_by":"Austin King"},{"issue_id":"speck-9fi","depends_on_id":"speck-peq","type":"blocks","created_at":"2026-02-20T17:47:07.163055478Z","created_by":"Austin King"}]}
{"id":"speck-9p7","title":"Define port traits for all external boundaries","description":"Define all 7 port traits in src/ports/. These are the Rust trait definitions that form the boundary between Speck's application core and the outside world. No implementations yet — just the trait signatures and any supporting types (request/response structs).\n\nPRD ref: Hexagonal Architecture — Port Inventory table. Also see docs/deterministic-replay.md for trait sketches.\n\n## Done when\n- [x] src/ports/clock.rs defines pub trait Clock: Send + Sync with fn now(\u0026self) -\u003e DateTime\u003cUtc\u003e\n- [x] src/ports/llm.rs defines pub trait LlmClient: Send + Sync with async complete method, plus CompletionRequest and CompletionResponse types\n- [x] src/ports/filesystem.rs defines pub trait FileSystem: Send + Sync with read_to_string, write, exists, list_dir methods\n- [x] src/ports/git.rs defines pub trait GitRepo: Send + Sync with current_commit, diff, list_files methods\n- [x] src/ports/shell.rs defines pub trait ShellExecutor: Send + Sync with run method, plus ShellOutput type\n- [x] src/ports/id_gen.rs defines pub trait IdGenerator: Send + Sync with generate_id method\n- [x] src/ports/issues.rs defines pub trait IssueTracker: Send + Sync with create_issue, update_issue, list_issues methods\n- [x] src/ports/mod.rs re-exports all traits and types\n- [x] cargo check passes\n\n## Verify\n- Run: cargo check\n- Expect: passes\n\n## Affected files\n- src/ports/mod.rs (modified)\n- src/ports/clock.rs (new)\n- src/ports/llm.rs (new)\n- src/ports/filesystem.rs (new)\n- src/ports/git.rs (new)\n- src/ports/shell.rs (new)\n- src/ports/id_gen.rs (new)\n- src/ports/issues.rs (new)","notes":"## Verify\n- Run: `cargo check`\n- Expect: Compiles with no errors\n- Run: `grep -rc 'pub trait' src/ports/ | grep -v :0`\n- Expect: 7 files with trait definitions","status":"closed","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-22T07:53:58.939995-08:00","closed_at":"2026-02-22T07:53:58.939995-08:00","close_reason":"Define port traits for all external boundaries; fix pre-existing cargo fmt issues","dependencies":[{"issue_id":"speck-9p7","depends_on_id":"speck-e03","type":"blocks","created_at":"2026-02-20T17:47:07.003717205Z","created_by":"Austin King"}]}
{"id":"speck-a6i","title":"Implement spec show, status, and deps inspection commands","description":"Implement the three inspection subcommands: show (display a single task spec), status (overview of all tasks), and deps (dependency graph). These are read-only views into the spec store.\n\nPRD ref: CLI Design — spec show, spec status, spec deps.\n\n## Done when\n- [ ] \\`speck show \u003cSPEC_ID\u003e\\` pretty-prints a full task spec (what an agent sees when picking up a task)\n- [ ] \\`speck status\\` shows a table of all task specs: ID, title, signal type, verification status (if validated)\n- [ ] \\`speck deps\\` shows the dependency graph in text format (which tasks block which)\n- [ ] All commands read from spec store via ctx.fs\n- [ ] \\`cargo check\\` passes\n- [ ] \\`cargo test\\` passes\n\n## Verify\n- Run: \\`cargo run -- show --help \u0026\u0026 cargo run -- status --help \u0026\u0026 cargo run -- deps --help\\`\n- Expect: All three show valid help text\n\n## Affected files\n- src/main.rs (modified — wire show, status, deps subcommands)\n- src/inspect/mod.rs (new)\n- src/inspect/show.rs (new)\n- src/inspect/status.rs (new)\n- src/inspect/deps.rs (new)\n- src/lib.rs (modified — add inspect module)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-a6i","depends_on_id":"speck-p81","type":"blocks","created_at":"2026-02-20T17:51:43.691543936Z","created_by":"Austin King"},{"issue_id":"speck-a6i","depends_on_id":"speck-gyx","type":"blocks","created_at":"2026-02-20T17:51:43.715176952Z","created_by":"Austin King"}]}
{"id":"speck-c0g","title":"Implement cassette format and recorder","description":"Define the cassette data structures (Cassette, Interaction) with serde serialization, and implement CassetteRecorder that appends interactions and writes the monolithic YAML file to disk.\n\nPRD ref: Hexagonal Architecture — Cassette Files. docs/deterministic-replay.md — Cassette Format.\n\n## Done when\n- [ ] `src/cassette/format.rs` defines `Cassette` struct (name, recorded_at, commit, interactions) and `Interaction` struct (seq, port, method, input as serde_json::Value, output as serde_json::Value)\n- [ ] Both structs derive Serialize + Deserialize\n- [ ] `src/cassette/recorder.rs` defines `CassetteRecorder` with `new(path)`, `record(interaction)`, and `finish()` (writes YAML to disk)\n- [ ] Interactions are assigned sequential `seq` numbers automatically\n- [ ] Unit test: create a recorder, record 3 interactions, finish, read back the file, assert all 3 interactions present with correct seq numbers\n- [ ] Unit test: cassette YAML round-trips (serialize then deserialize produces identical struct)\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: cargo test cassette\n- Expect: All cassette tests pass\n\n## Affected files\n- src/cassette/mod.rs (modified)\n- src/cassette/format.rs (new)\n- src/cassette/recorder.rs (new)\n","notes":"## Verify\n- Run: cargo test cassette\n- Expect: All cassette tests pass","status":"closed","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-22T07:58:33.828052-08:00","closed_at":"2026-02-22T07:58:33.828052-08:00","close_reason":"Implement cassette format and recorder","dependencies":[{"issue_id":"speck-c0g","depends_on_id":"speck-e03","type":"blocks","created_at":"2026-02-20T17:47:07.049064053Z","created_by":"Austin King"}]}
{"id":"speck-de5","title":"Wire spec validate subcommand in CLI","description":"Wire the validate subcommand in main.rs to the validation engine. Supports both single-spec validation and --all mode.\n\nPRD ref: CLI Design — spec validate IMPACT-42, spec validate --all.\n\n## Done when\n- [ ] `speck validate \u003cSPEC_ID\u003e` loads and validates a single task spec, prints results\n- [ ] `speck validate --all` validates all task specs in the store\n- [ ] Exit code 0 when all checks pass, non-zero when any fail\n- [ ] Human-readable output showing each check and its pass/fail status\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo run -- validate --help`\n- Expect: Shows usage with SPEC_ID positional arg and --all flag\n- Run: `cargo test cli_validate` (with cassette-based test)\n- Expect: Tests pass\n\n## Affected files\n- src/main.rs (modified — wire validate subcommand)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-de5","depends_on_id":"speck-qno","type":"blocks","created_at":"2026-02-20T17:47:13.910086585Z","created_by":"Austin King"}]}
{"id":"speck-dl7","title":"Add record-replay round-trip integration test","description":"Create the first full-stack integration test that proves the record/replay system works end-to-end. Record a session using ServiceContext::recording(), split the cassette, replay using ServiceContext::replaying_from(), and assert identical outputs. This is the first test that exercises the entire hex architecture stack together.\n\nPRD ref: Verification Requirements — Recording fidelity and Cassette determinism.\n\n## Done when\n- [ ] Integration test in tests/record_replay.rs\n- [ ] Test creates a ServiceContext::recording(), exercises multiple ports (clock, fs, id_gen at minimum), finishes the recording\n- [ ] Test loads the recorded cassette, constructs ServiceContext::replaying(), exercises the same code path\n- [ ] Test asserts that the outputs from recording and replaying are identical\n- [ ] Test runs the replay a second time and asserts outputs are still identical (determinism check)\n- [ ] Banned-import check: grep for std::fs::, std::time::, chrono::Utc::now in src/ excluding src/adapters/ returns zero matches\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test record_replay`\n- Expect: Integration test passes — recording and replaying produce identical results\n- Run: `grep -r \"std::fs::\" src/ --include=\"*.rs\" | grep -v \"src/adapters/\"` and similar for other banned imports\n- Expect: Zero matches (all external calls go through ports)\n\n## Affected files\n- tests/record_replay.rs (new)","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-dl7","depends_on_id":"speck-skv","type":"blocks","created_at":"2026-02-20T17:47:07.255795486Z","created_by":"Austin King"},{"issue_id":"speck-dl7","depends_on_id":"speck-9fi","type":"blocks","created_at":"2026-02-20T17:47:07.278335473Z","created_by":"Austin King"}]}
{"id":"speck-e03","title":"Scaffold Cargo project with workspace layout","description":"Initialize the Rust project with Cargo.toml, set up the top-level binary crate (speck), and establish the directory layout matching our hexagonal architecture. This is the very first bead — everything else depends on it compiling.\n\nPRD ref: Build Path step 1, Hexagonal Architecture section.\n\n## Done when\n- [ ] `Cargo.toml` exists with project name `speck`, edition 2021, initial dependencies (clap, serde, serde_yaml, chrono, serde_json)\n- [ ] `src/main.rs` exists with a minimal clap CLI that parses subcommands: plan, validate, map, show, status, deps (all stubs that print \"not yet implemented\")\n- [ ] `src/lib.rs` exists and re-exports the module tree\n- [ ] Directory structure created: `src/ports/`, `src/adapters/`, `src/adapters/live/`, `src/adapters/recording/`, `src/adapters/replaying/`, `src/cassette/`, `src/plan/`, `src/validate/`, `src/map/`\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes (even if there are no tests yet)\n- [ ] `speck --help` prints subcommand list\n\n## Verify\n- Run: cargo build --release\n- Expect: exit code 0\n- Run: ./target/release/speck --help\n- Expect: exit code 0\n- Run: cargo test --release\n- Expect: exit code 0\n\n## Affected files\n- Cargo.toml (new)\n- src/main.rs (new)\n- src/lib.rs (new)\n- src/ports/mod.rs (new)\n- src/adapters/mod.rs (new)\n- src/plan/mod.rs (new)\n- src/validate/mod.rs (new)\n- src/map/mod.rs (new)\n- src/cassette/mod.rs (new)","notes":"## Verify\n- Run: cargo build --release\n- Expect: exit code 0\n- Run: ./target/release/speck --help\n- Expect: exit code 0\n- Run: cargo test --release\n- Expect: exit code 0","status":"closed","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-22T07:48:47.707335-08:00","closed_at":"2026-02-22T07:48:47.707335-08:00","close_reason":"Fix flaky tests: eliminate env var races in command tests"}
{"id":"speck-ec1","title":"Implement IssueTracker live adapter for Beads","description":"Replace the stub IssueTracker live adapter with a real implementation that calls the bd CLI. Supports creating issues, updating status, listing issues, and wiring dependencies.\n\nPRD ref: Integration with Issue Tracking. Port Inventory — IssueTracker.\n\n## Done when\n- [ ] \\`src/adapters/live/issues.rs\\` implements IssueTracker by shelling out to bd CLI (via ctx.shell)\n- [ ] create_issue maps TaskSpec to bd create command with title, type, priority, description\n- [ ] update_issue maps to bd update\n- [ ] list_issues maps to bd list --json and parses output\n- [ ] add_dependency maps to bd dep add\n- [ ] Error handling: returns meaningful errors when bd CLI fails\n- [ ] \\`cargo check\\` passes\n- [ ] \\`cargo test\\` passes (tests use replaying adapter, not live bd)\n\n## Verify\n- Run: \\`cargo test issues\\`\n- Expect: Tests pass using replaying adapter\n\n## Affected files\n- src/adapters/live/issues.rs (modified)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-ec1","depends_on_id":"speck-sm5","type":"blocks","created_at":"2026-02-20T17:51:43.786846372Z","created_by":"Austin King"}]}
{"id":"speck-gyx","title":"Implement codebase map generation","description":"Implement the codebase cartography tool that generates a structural snapshot of the target project. The map includes directory structure, module boundaries, key interfaces, and test infrastructure. Tied to a commit hash, treated as a derived artifact.\n\nPRD ref: Two-Pass Planning — Pass 1. Storage Architecture — Codebase map lifecycle. Build Path step 5.\n\n## Done when\n- [ ] `src/map/mod.rs` defines CodebaseMap struct with fields: commit_hash, generated_at, modules (list of module summaries), directory_tree, test_infrastructure\n- [ ] `src/map/generator.rs` implements map generation: walks project files via ctx.fs, identifies module boundaries (directories with mod.rs or lib.rs), lists key interfaces\n- [ ] `src/map/mod.rs` defines ModuleSummary struct with: path, public_items (functions, structs, traits), dependencies\n- [ ] Map is serialized as YAML to .spec-cache/codebase_map.yaml\n- [ ] Map includes the commit hash it was generated against (via ctx.git)\n- [ ] All I/O goes through ServiceContext ports\n- [ ] Unit test with replaying cassette: generate a map from a known project structure\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test map`\n- Expect: Map generation tests pass, produces valid YAML output\n\n## Affected files\n- src/map/mod.rs (modified)\n- src/map/generator.rs (new)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-gyx","depends_on_id":"speck-sm5","type":"blocks","created_at":"2026-02-20T17:47:13.956563306Z","created_by":"Austin King"}]}
{"id":"speck-jrx","title":"Implement LLM client live adapter with Claude API","description":"Replace the stub LLM live adapter with a real implementation that calls the Claude API (Anthropic messages API). Uses reqwest for HTTP. API key read via ANTHROPIC_API_KEY env var. This unblocks all LLM-dependent features (spec plan).\n\nPRD ref: Port Inventory — LlmClient.\n\n## Done when\n- [ ] `src/adapters/live/llm.rs` implements LlmClient using reqwest to call Anthropic messages API\n- [ ] Reads API key from ANTHROPIC_API_KEY environment variable\n- [ ] Supports streaming=false for simplicity in initial implementation\n- [ ] Properly maps CompletionRequest to Anthropic API request format\n- [ ] Properly maps Anthropic API response to CompletionResponse\n- [ ] Returns meaningful error on missing API key, network failure, API error\n- [ ] Add reqwest and tokio to Cargo.toml dependencies\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes (existing tests unaffected — they use replaying adapters)\n\n## Verify\n- Run: `cargo check`\n- Expect: Compiles with no errors\n- Run: `ANTHROPIC_API_KEY=test cargo test llm` (unit tests using replaying adapter, not live API)\n- Expect: Tests pass\n\n## Affected files\n- src/adapters/live/llm.rs (modified)\n- Cargo.toml (modified — add reqwest, tokio)","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-jrx","depends_on_id":"speck-sm5","type":"blocks","created_at":"2026-02-20T17:47:22.335061265Z","created_by":"Austin King"}]}
{"id":"speck-mzn","title":"Define task spec YAML schema and Rust types","description":"Define the Rust types for the task spec format and ensure they round-trip through YAML. This is the contract that spec plan produces and spec validate consumes. Includes signal type classification, verification strategies, and abstract codebase references.\n\nPRD ref: Task Spec Format (Draft) section — all three YAML examples.\n\n## Done when\n- [ ] `src/spec/mod.rs` exists with module declarations\n- [ ] `src/spec/task_spec.rs` defines TaskSpec struct with fields: id, title, requirement, context (modules, patterns, dependencies), acceptance_criteria, signal_type, verification\n- [ ] `src/spec/signal.rs` defines SignalType enum: Clear, Fuzzy, InternalLogic\n- [ ] `src/spec/verification.rs` defines VerificationStrategy enum with variants: DirectAssertion, RefactorToExpose, TraceAssertion — each with their specific fields\n- [ ] `src/spec/check.rs` defines VerificationCheck enum with variants: TestSuite, SqlAssertion, CommandOutput, MigrationRollback, Custom\n- [ ] All types derive Serialize + Deserialize\n- [ ] Unit test: the three YAML examples from the PRD parse into the Rust types correctly\n- [ ] Unit test: round-trip (serialize then deserialize) produces identical structs\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test spec`\n- Expect: All spec schema tests pass, PRD examples parse correctly\n\n## Affected files\n- src/spec/mod.rs (new)\n- src/spec/task_spec.rs (new)\n- src/spec/signal.rs (new)\n- src/spec/verification.rs (new)\n- src/spec/check.rs (new)\n- src/lib.rs (modified — add spec module)","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-mzn","depends_on_id":"speck-e03","type":"blocks","created_at":"2026-02-20T17:47:13.819957451Z","created_by":"Austin King"}]}
{"id":"speck-nae","title":"Implement spec plan pass 2.5: reconciliation","description":"Implement the reconciliation pass that reviews all proposed task specs together after deep dives. Identifies duplicated efforts, shared abstractions that should be extracted, and dependency ordering issues.\n\nPRD ref: Two-Pass Planning — Pass 2.5: Reconciliation.\n\n## Done when\n- [ ] `src/plan/reconcile.rs` implements reconcile(ctx, task_specs) that reviews all specs\n- [ ] Detects duplicate work across task specs (same files modified, similar acceptance criteria)\n- [ ] Proposes shared abstractions when multiple tasks touch the same module similarly\n- [ ] Validates dependency ordering (no circular deps, foundational tasks come first)\n- [ ] Returns ReconciliationResult with suggested merges, extractions, and reorderings\n- [ ] Unit tests with replaying cassettes\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test reconcile`\n- Expect: All reconciliation tests pass\n\n## Affected files\n- src/plan/reconcile.rs (new)\n- src/plan/mod.rs (modified)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-nae","depends_on_id":"speck-118","type":"blocks","created_at":"2026-02-20T17:47:22.538676243Z","created_by":"Austin King"}]}
{"id":"speck-nag","title":"Implement spec plan pass 1: broad codebase survey","description":"Implement the first pass of the two-pass planning system: broad codebase survey. Reads project files, identifies module boundaries, key interfaces, cross-cutting concerns, and builds a routing table of where different types of work live. Uses the codebase map if available, or generates one.\n\nPRD ref: Two-Pass Planning — Pass 1: Broad Survey.\n\n## Done when\n- [ ] `src/plan/survey.rs` implements broad_survey(ctx, requirement) that explores the codebase\n- [ ] Uses ctx.fs and ctx.git to traverse project structure\n- [ ] Uses ctx.llm to analyze module purposes and identify cross-cutting concerns\n- [ ] Returns a SurveyResult with: routing_table (module -\u003e purpose), cross_cutting_concerns, foundational_gaps, dependency_graph\n- [ ] Reuses codebase map from .spec-cache/ if commit hash matches, regenerates otherwise\n- [ ] Unit tests with replaying cassettes\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test survey`\n- Expect: All survey tests pass\n\n## Affected files\n- src/plan/survey.rs (new)\n- src/plan/mod.rs (modified)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-nag","depends_on_id":"speck-jrx","type":"blocks","created_at":"2026-02-20T17:47:22.404250287Z","created_by":"Austin King"},{"issue_id":"speck-nag","depends_on_id":"speck-gyx","type":"blocks","created_at":"2026-02-20T17:47:22.425700087Z","created_by":"Austin King"}]}
{"id":"speck-p81","title":"Implement spec store for reading and writing task specs","description":"Implement the spec store — the persistence layer for task specs, requirements, and verification contracts. The store lives outside the target project's git repo. Uses the FileSystem port trait for all I/O (not direct std::fs).\n\nPRD ref: Storage Architecture — Three Separate Lifecycles, Storage Model.\n\n## Done when\n- [ ] `src/store/mod.rs` defines SpecStore struct that takes a \u0026ServiceContext and a store root path\n- [ ] `SpecStore::save_task_spec(spec)` writes a TaskSpec to YAML in the store\n- [ ] `SpecStore::load_task_spec(id)` reads a TaskSpec by ID\n- [ ] `SpecStore::list_task_specs()` lists all task specs in the store\n- [ ] `SpecStore::save_requirement(req)` saves a requirement document\n- [ ] Store directory layout: `\u003croot\u003e/requirements/`, `\u003croot\u003e/tasks/`, `\u003croot\u003e/history/`\n- [ ] All I/O goes through ctx.fs (not direct std::fs)\n- [ ] Unit test: save and load a task spec round-trips correctly\n- [ ] Unit test: list_task_specs returns all saved specs\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test store`\n- Expect: All store tests pass\n\n## Affected files\n- src/store/mod.rs (new)\n- src/lib.rs (modified — add store module)","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-p81","depends_on_id":"speck-mzn","type":"blocks","created_at":"2026-02-20T17:47:13.842130655Z","created_by":"Austin King"},{"issue_id":"speck-p81","depends_on_id":"speck-sm5","type":"blocks","created_at":"2026-02-20T17:47:13.864538023Z","created_by":"Austin King"}]}
{"id":"speck-peq","title":"Implement cassette replayer with per-port support","description":"Implement CassetteReplayer that loads a cassette (monolithic or per-port) and serves recorded interactions sequentially. Also implement CassetteConfig for composable per-port replay.\n\nPRD ref: Hexagonal Architecture — Composable Replay. docs/deterministic-replay.md — Replay Matching Strategy.\n\n## Done when\n- [ ] `src/cassette/replayer.rs` defines `CassetteReplayer` with `new(cassette)`, `next_interaction(port, method)` that returns the next interaction for that port/method pair\n- [ ] Replayer panics with a clear error message when cassette is exhausted (showing what was expected vs requested)\n- [ ] `src/cassette/config.rs` defines `CassetteConfig` with optional path per port (llm, fs, git, clock, shell, id_gen, issues)\n- [ ] `CassetteConfig::panic_on_unspecified()` returns a config where all paths are None (ports panic if called without a cassette)\n- [ ] `CassetteConfig` can load from a monolithic cassette (filters interactions by port field) or from per-port files\n- [ ] Unit test: load a monolithic cassette, replay interactions in order, verify outputs match\n- [ ] Unit test: load per-port cassettes, replay, verify each port gets its own stream\n- [ ] Unit test: calling next_interaction on exhausted replayer panics with descriptive message\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test cassette`\n- Expect: All cassette tests pass including replayer tests\n\n## Affected files\n- src/cassette/mod.rs (modified)\n- src/cassette/replayer.rs (new)\n- src/cassette/config.rs (new)","status":"open","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-peq","depends_on_id":"speck-c0g","type":"blocks","created_at":"2026-02-20T17:47:07.071293002Z","created_by":"Austin King"}]}
{"id":"speck-qno","title":"Implement spec validate core: load spec and run checks","description":"Implement the core validation engine that loads a task spec from the store and runs its verification checks. This is the exit gate — it proves work is done. Supports test_suite checks (run a command, assert exit code), command_output checks (run command, assert on stdout), and abstract reference resolution against the codebase.\n\nPRD ref: The Core Idea — Validate. Build Path step 3.\n\n## Done when\n- [ ] `src/validate/mod.rs` defines `validate(ctx, spec_id)` that loads a TaskSpec and runs all its verification checks\n- [ ] `src/validate/runner.rs` implements check runners for: TestSuite (runs command via ctx.shell, checks exit code), CommandOutput (runs command, matches expected output)\n- [ ] `src/validate/reference.rs` resolves abstract module references against the codebase (checks files exist via ctx.fs)\n- [ ] Returns a ValidationResult with per-check pass/fail and overall status\n- [ ] Prints a human-readable report of results\n- [ ] All I/O goes through ServiceContext ports\n- [ ] Unit test with replaying cassette: validate a spec with all-passing checks\n- [ ] Unit test with replaying cassette: validate a spec where one check fails\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo test validate`\n- Expect: All validate tests pass including both pass and fail scenarios\n\n## Affected files\n- src/validate/mod.rs (modified)\n- src/validate/runner.rs (new)\n- src/validate/reference.rs (new)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-qno","depends_on_id":"speck-p81","type":"blocks","created_at":"2026-02-20T17:47:13.887411762Z","created_by":"Austin King"}]}
{"id":"speck-s6w","title":"Implement linkage resolution and drift detection","description":"Implement the linkage layer that resolves abstract spec references against the current codebase map and detects drift. When a spec references \"MetricsService\" abstractly, linkage resolves it to the actual file path. When that file changes after the spec was written, drift detection warns.\n\nPRD ref: Storage Architecture — Linkage lifecycle. Three Separate Lifecycles.\n\n## Done when\n- [ ] \\`src/linkage/mod.rs\\` defines the linkage resolution engine\n- [ ] \\`resolve(ctx, spec, codebase_map)\\` maps abstract module references to concrete file paths\n- [ ] \\`detect_drift(ctx, spec, old_map, new_map)\\` identifies specs whose referenced modules have changed\n- [ ] Drift report shows: which specs are affected, what changed, whether re-planning is recommended\n- [ ] Integrated into \\`speck validate\\` — validation warns on drift before running checks\n- [ ] All I/O through ServiceContext ports\n- [ ] Unit tests with replaying cassettes\n- [ ] \\`cargo check\\` passes\n- [ ] \\`cargo test\\` passes\n\n## Verify\n- Run: \\`cargo test linkage\\`\n- Expect: All linkage tests pass — resolution and drift detection work\n\n## Affected files\n- src/linkage/mod.rs (new)\n- src/linkage/resolve.rs (new)\n- src/linkage/drift.rs (new)\n- src/lib.rs (modified — add linkage module)\n- src/validate/mod.rs (modified — integrate drift check)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-s6w","depends_on_id":"speck-p81","type":"blocks","created_at":"2026-02-20T17:51:43.739436049Z","created_by":"Austin King"},{"issue_id":"speck-s6w","depends_on_id":"speck-gyx","type":"blocks","created_at":"2026-02-20T17:51:43.763788521Z","created_by":"Austin King"}]}
{"id":"speck-skv","title":"Implement recording adapters for all ports","description":"Implement recording adapters for all 7 port traits. Each recording adapter wraps a live adapter, delegates to it, and records every interaction to a shared CassetteRecorder. Also add ServiceContext::recording() constructor.\n\nPRD ref: Hexagonal Architecture — Recording Adapter Pattern. docs/deterministic-replay.md — Recording Adapter Pattern.\n\n## Done when\n- [ ] src/adapters/recording/clock.rs — RecordingClock wraps dyn Clock, records now() calls\n- [ ] src/adapters/recording/filesystem.rs — RecordingFileSystem wraps dyn FileSystem, records all calls\n- [ ] src/adapters/recording/git.rs — RecordingGitRepo wraps dyn GitRepo, records all calls\n- [ ] src/adapters/recording/shell.rs — RecordingShellExecutor wraps dyn ShellExecutor, records all calls\n- [ ] src/adapters/recording/id_gen.rs — RecordingIdGenerator wraps dyn IdGenerator, records all calls\n- [ ] src/adapters/recording/llm.rs — RecordingLlmClient wraps dyn LlmClient, records all calls\n- [ ] src/adapters/recording/issues.rs — RecordingIssueTracker wraps dyn IssueTracker, records all calls\n- [ ] All recording adapters share an Arc\u003cMutex\u003cCassetteRecorder\u003e\u003e\n- [ ] ServiceContext::recording(path) constructor wires live adapters wrapped in recording adapters\n- [ ] Records both Ok and Err results\n- [ ] cargo check passes\n- [ ] cargo test passes\n\n## Verify\n- Run: cargo test recording\n- Expect: Tests pass — a recording context can be constructed and used\n\n## Affected files\n- src/adapters/recording/mod.rs (new)\n- src/adapters/recording/clock.rs (new)\n- src/adapters/recording/filesystem.rs (new)\n- src/adapters/recording/git.rs (new)\n- src/adapters/recording/shell.rs (new)\n- src/adapters/recording/id_gen.rs (new)\n- src/adapters/recording/llm.rs (new)\n- src/adapters/recording/issues.rs (new)\n- src/adapters/mod.rs (modified)\n- src/context.rs (modified — add recording() constructor)","notes":"## Verify\n- Run: cargo test recording\n- Expect: Tests pass — a recording context can be constructed and used","status":"closed","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-22T08:12:56.61501-08:00","closed_at":"2026-02-22T08:12:56.61501-08:00","close_reason":"All recording adapters already implemented — verified all deliverables pass","dependencies":[{"issue_id":"speck-skv","depends_on_id":"speck-sm5","type":"blocks","created_at":"2026-02-20T17:47:07.092942581Z","created_by":"Austin King"},{"issue_id":"speck-skv","depends_on_id":"speck-c0g","type":"blocks","created_at":"2026-02-20T17:47:07.116794473Z","created_by":"Austin King"}]}
{"id":"speck-sm5","title":"Implement ServiceContext struct and live constructor","description":"Create the ServiceContext struct that bundles all port trait objects, and implement ServiceContext::live() which wires up the real (live) adapters. This requires implementing live adapters for all 7 ports.\n\nPRD ref: Hexagonal Architecture — ServiceContext and Adapter Modes.\n\n## Done when\n- [x] `src/context.rs` defines `pub struct ServiceContext` with fields for all 7 port trait objects (Box\u003cdyn Trait\u003e)\n- [x] `ServiceContext::live()` constructor exists and returns a context with all live adapters\n- [x] `src/adapters/live/clock.rs` implements `Clock` using `chrono::Utc::now()`\n- [x] `src/adapters/live/filesystem.rs` implements `FileSystem` using `std::fs`\n- [x] `src/adapters/live/git.rs` implements `GitRepo` using `std::process::Command` for git\n- [x] `src/adapters/live/shell.rs` implements `ShellExecutor` using `std::process::Command`\n- [x] `src/adapters/live/id_gen.rs` implements `IdGenerator` (UUID or similar)\n- [x] `src/adapters/live/llm.rs` implements `LlmClient` as a stub (returns error \"not configured\") — real LLM integration is a later bead\n- [x] `src/adapters/live/issues.rs` implements `IssueTracker` as a stub\n- [x] `cargo check` passes\n- [x] `cargo test` passes\n\n## Affected files\n- src/context.rs (new)\n- src/lib.rs (modified — add context module)\n- src/adapters/mod.rs (modified)\n- src/adapters/live/mod.rs (new)\n- src/adapters/live/clock.rs (new)\n- src/adapters/live/filesystem.rs (new)\n- src/adapters/live/git.rs (new)\n- src/adapters/live/shell.rs (new)\n- src/adapters/live/id_gen.rs (new)\n- src/adapters/live/llm.rs (new)\n- src/adapters/live/issues.rs (new)\n","notes":"## Verify\n- Run: `cargo test --release`\n- Expect: All tests pass\n- Run: `cargo check`\n- Expect: No errors","status":"closed","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-22T08:08:36.53731-08:00","closed_at":"2026-02-22T08:03:24.080018-08:00","close_reason":"Add explicit live constructor test and verify all deliverables","dependencies":[{"issue_id":"speck-sm5","depends_on_id":"speck-9p7","type":"blocks","created_at":"2026-02-20T17:47:07.02555495Z","created_by":"Austin King"}]}
{"id":"speck-uui","title":"Wire spec map subcommand with --diff support","description":"Wire the map subcommand in main.rs. Plain `speck map` regenerates the codebase map. `speck map --diff` shows what changed since the last map.\n\nPRD ref: CLI Design — spec map, spec map --diff.\n\n## Done when\n- [ ] `speck map` generates a new codebase map and writes it to .spec-cache/codebase_map.yaml\n- [ ] `speck map --diff` loads the previous map and current map, displays differences (added/removed modules, changed interfaces)\n- [ ] Prints summary of map contents after generation\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `cargo run -- map --help`\n- Expect: Shows usage with --diff flag\n- Run: `cargo test cli_map`\n- Expect: Tests pass\n\n## Affected files\n- src/main.rs (modified — wire map subcommand)\n- src/map/diff.rs (new)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-uui","depends_on_id":"speck-gyx","type":"blocks","created_at":"2026-02-20T17:47:13.99132893Z","created_by":"Austin King"}]}
{"id":"speck-wgu","title":"Add SPECK_RECORD env var support to CLI","description":"Wire the CLI main.rs to check for SPECK_RECORD environment variable at startup. If set, construct ServiceContext::recording(path) instead of ServiceContext::live(). This is the developer-only mechanism for capturing cassettes — not exposed in --help.\n\nPRD ref: Record/Replay Is Internal Only section.\n\n## Done when\n- [ ] main.rs checks `std::env::var(\"SPECK_RECORD\")` at startup\n- [ ] If SPECK_RECORD is set, constructs ServiceContext::recording(path)\n- [ ] If SPECK_RECORD is not set, constructs ServiceContext::live()\n- [ ] On recording context drop/finish, the cassette file is written to the SPECK_RECORD path\n- [ ] SPECK_RECORD is NOT mentioned in --help output\n- [ ] `cargo check` passes\n- [ ] `cargo test` passes\n\n## Verify\n- Run: `SPECK_RECORD=/tmp/test-cassette.yaml cargo run -- --help`\n- Expect: Help text prints normally, cassette file is created (may be empty if no port calls made)\n- Run: `cargo run -- --help` (without env var)\n- Expect: Normal operation, no cassette file created\n\n## Affected files\n- src/main.rs (modified)","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-wgu","depends_on_id":"speck-skv","type":"blocks","created_at":"2026-02-20T17:47:07.187118242Z","created_by":"Austin King"},{"issue_id":"speck-wgu","depends_on_id":"speck-9fi","type":"blocks","created_at":"2026-02-20T17:47:07.209554439Z","created_by":"Austin King"}]}
{"id":"speck-wuk","title":"Implement recursive feedback: validation failure flows back to plan","description":"When spec validate fails, the failure information should be structured and available for spec plan to consume. This closes the feedback loop: either the implementation needs fixing, or the spec itself was flawed and plan should revise the contract.\n\nPRD ref: The Recursive Feedback Property.\n\n## Done when\n- [ ] ValidationResult includes structured failure details: which checks failed, actual vs expected, failure context\n- [ ] \\`src/plan/feedback.rs\\` can ingest a ValidationResult and propose spec revisions\n- [ ] Distinguishes between implementation failures (agent needs to iterate) and spec flaws (plan revises contract)\n- [ ] \\`speck validate\\` output includes actionable next steps based on failure type\n- [ ] Unit tests with replaying cassettes: validation failure triggers correct feedback classification\n- [ ] \\`cargo check\\` passes\n- [ ] \\`cargo test\\` passes\n\n## Verify\n- Run: \\`cargo test feedback\\`\n- Expect: All feedback loop tests pass\n\n## Affected files\n- src/plan/feedback.rs (new)\n- src/plan/mod.rs (modified)\n- src/validate/mod.rs (modified — enrich ValidationResult)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-wuk","depends_on_id":"speck-qno","type":"blocks","created_at":"2026-02-20T17:51:43.858121877Z","created_by":"Austin King"},{"issue_id":"speck-wuk","depends_on_id":"speck-118","type":"blocks","created_at":"2026-02-20T17:51:43.880834104Z","created_by":"Austin King"}]}
{"id":"speck-xsv","title":"Wire spec sync subcommand for Beads integration","description":"Wire the sync subcommand. \\`speck sync beads\\` pushes task spec summaries to Beads as issues, wires dependencies, and keeps status bidirectional. \\`--dry-run\\` shows what would be created/updated without doing it.\n\nPRD ref: CLI Design — spec sync beads, spec sync beads --dry-run. Integration with Issue Tracking.\n\n## Done when\n- [ ] \\`speck sync beads\\` creates/updates Beads issues for all task specs in the store\n- [ ] Maps task spec fields to Beads issue fields (title, description with acceptance criteria, dependencies)\n- [ ] Tracks which specs have already been synced (idempotent — re-running doesn't create duplicates)\n- [ ] \\`speck sync beads --dry-run\\` prints what would happen without making changes\n- [ ] \\`cargo check\\` passes\n- [ ] \\`cargo test\\` passes\n\n## Verify\n- Run: \\`cargo run -- sync --help\\`\n- Expect: Shows usage with beads positional arg and --dry-run flag\n\n## Affected files\n- src/main.rs (modified — wire sync subcommand)\n- src/sync/mod.rs (new)\n- src/sync/beads.rs (new)\n- src/lib.rs (modified — add sync module)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-21T08:17:35.219654-08:00","created_by":"Austin King","updated_at":"2026-02-21T08:17:35.219654-08:00","dependencies":[{"issue_id":"speck-xsv","depends_on_id":"speck-ec1","type":"blocks","created_at":"2026-02-20T17:51:43.811405635Z","created_by":"Austin King"},{"issue_id":"speck-xsv","depends_on_id":"speck-p81","type":"blocks","created_at":"2026-02-20T17:51:43.834904026Z","created_by":"Austin King"}]}
